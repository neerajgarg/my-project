pipeline {
    agent any
    stages {
        stage ('Deploy') {
            steps{
                sshagent(credentials : ['78058c98-3b9d-4d81-8bc5-e50b40f9072e']) {
                    sh 'ssh -o StrictHostKeyChecking=no ubuntu@54.184.4.119 uptime'
                    sh 'ssh -o StrictHostKeyChecking=no ubuntu@54.184.4.119 ls -ltr'
                    sh 'scp -r requirements.txt ubuntu@54.184.4.119:/home/ubuntu/navneet/'
                    sh 'echo "printing the xml file"'
                    sh 'ssh -o StrictHostKeyChecking=no ubuntu@54.184.4.119 git init'
                    sh 'ssh -o StrictHostKeyChecking=no ubuntu@54.184.4.119 git add /home/ubuntu/sample_report.xml'
                    sh 'ssh -o StrictHostKeyChecking=no ubuntu@54.184.4.119 git commit --amend -m "the"'
                    sh 'ssh -o StrictHostKeyChecking=no ubuntu@54.184.4.119 git remote add origin https://github.com/neerajgarg/my-project.git'
                    sh 'ssh -o StrictHostKeyChecking=no ubuntu@54.184.4.119 git push -u origin master'
                    sh 'ssh -o StrictHostKeyChecking=no ubuntu@54.184.4.119 cat /home/ubuntu/navneet/sample_report.xml'
                    
                    
                }
            }
        }
    }
    post {
        always{
            sh 'python tims.py -results_xml sample_report.xml --show-log -l tims_log -folder_id Tps4528779f'
        }
    }
}
